# å……å€¼æ¥å£æµ‹è¯•è„šæœ¬ä½¿ç”¨è¯´æ˜

## æµ‹è¯•è„šæœ¬

æä¾›äº†ä¸¤ä¸ªç‰ˆæœ¬çš„æµ‹è¯•è„šæœ¬:

### 1. Bash ç‰ˆæœ¬ (Linux/Mac)
```bash
test_recharge_api.sh
```

### 2. Go ç‰ˆæœ¬ (è·¨å¹³å°)
```bash
test_recharge.go
```

## ä½¿ç”¨æ–¹æ³•

### æ–¹æ³• 1: ä½¿ç”¨ Go æµ‹è¯•è„šæœ¬ (æ¨è)

**æ­¥éª¤ 1:** å¯åŠ¨æœåŠ¡
```bash
cd novel-resource-management
go run main.go
```

**æ­¥éª¤ 2:** æ‰“å¼€æ–°ç»ˆç«¯,è¿è¡Œæµ‹è¯•
```bash
cd novel-resource-management
go run test_recharge.go
```

### æ–¹æ³• 2: ä½¿ç”¨ Bash æµ‹è¯•è„šæœ¬ (ä»… Mac/Linux)

**æ­¥éª¤ 1:** å¯åŠ¨æœåŠ¡
```bash
cd novel-resource-management
go run main.go
```

**æ­¥éª¤ 2:** æ‰“å¼€æ–°ç»ˆç«¯,è¿è¡Œæµ‹è¯•
```bash
cd novel-resource-management
chmod +x test_recharge_api.sh
./test_recharge_api.sh
```

### æ–¹æ³• 3: æ‰‹åŠ¨æµ‹è¯• (ä½¿ç”¨ curl)

**æ­¥éª¤ 1:** å¯åŠ¨æœåŠ¡
```bash
cd novel-resource-management
go run main.go
```

**æ­¥éª¤ 2:** æŸ¥è¯¢å½“å‰ç§¯åˆ†
```bash
curl http://localhost:8080/api/v1/users/691058f50987397c91e4e078
```

**æ­¥éª¤ 3:** å‘é€å……å€¼è¯·æ±‚
```bash
curl -X POST http://localhost:8080/api/v1/users/recharge \
  -H "Content-Type: application/json" \
  -d '{
    "title": "150 Token å……å€¼åŒ…",
    "order_sn": "ORDER20250126001",
    "email": "beetle5249@gmail.com",
    "actual_price": 150,
    "order_info": "ç”¨æˆ·å……å€¼è´¦å·",
    "good_id": "GOOD_001",
    "gd_name": "150 Tokenå¥—é¤"
  }'
```

**æ­¥éª¤ 4:** å†æ¬¡æŸ¥è¯¢ç§¯åˆ†éªŒè¯
```bash
curl http://localhost:8080/api/v1/users/691058f50987397c91e4e078
```

## æµ‹è¯•è„šæœ¬åŠŸèƒ½

æµ‹è¯•è„šæœ¬ä¼šè‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹æ­¥éª¤:

1. âœ… **æœåŠ¡å¥åº·æ£€æŸ¥** - éªŒè¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
2. âœ… **æŸ¥è¯¢å½“å‰ç§¯åˆ†** - è·å–å……å€¼å‰çš„ç§¯åˆ†å€¼
3. âœ… **å‘é€å……å€¼è¯·æ±‚** - è°ƒç”¨å……å€¼æ¥å£å¢åŠ 150 Token
4. âœ… **éªŒè¯å……å€¼ç»“æœ** - æ£€æŸ¥ç§¯åˆ†æ˜¯å¦æ­£ç¡®å¢åŠ 
5. âœ… **é”™è¯¯å¤„ç†æµ‹è¯•** - æµ‹è¯•ç”¨æˆ·ä¸å­˜åœ¨çš„æƒ…å†µ

## é¢„æœŸè¾“å‡º

### æˆåŠŸè¾“å‡ºç¤ºä¾‹:
```
=========================================
       å……å€¼æ¥å£æµ‹è¯•è„šæœ¬
=========================================

1. æ£€æŸ¥æœåŠ¡çŠ¶æ€...
âœ… æœåŠ¡æ­£å¸¸è¿è¡Œ

2. æŸ¥è¯¢å½“å‰ç§¯åˆ†...
å½“å‰ç§¯åˆ†: 44

3. å‘é€å……å€¼è¯·æ±‚...
å……å€¼æ•°æ®:
  é‚®ç®±: beetle5249@gmail.com
  å……å€¼é‡‘é¢: 150 Token
  è®¢å•å·: TEST_ORDER_1706234567

å……å€¼å“åº”:
{
  "message": "å……å€¼æˆåŠŸ",
  "userId": "691058f50987397c91e4e078",
  "email": "beetle5249@gmail.com",
  "orderSn": "TEST_ORDER_1706234567",
  "goodName": "150 Tokenå¥—é¤",
  "addedTokens": 150,
  "newCredit": 194
}

âœ… å……å€¼æˆåŠŸ!
å……å€¼åç§¯åˆ†: 194
âœ… ç§¯åˆ†éªŒè¯é€šè¿‡: +150 Token

4. å†æ¬¡æŸ¥è¯¢ç§¯åˆ†ç¡®è®¤...
âœ… æ•°æ®ä¸€è‡´: 194

5. æµ‹è¯•ç”¨æˆ·ä¸å­˜åœ¨çš„æƒ…å†µ...
âœ… é”™è¯¯å¤„ç†æ­£ç¡®: æ­£ç¡®è¯†åˆ«äº†ä¸å­˜åœ¨çš„ç”¨æˆ·

=========================================
âœ… æµ‹è¯•å®Œæˆ!
=========================================

æ€»ç»“:
  âœ… æœåŠ¡çŠ¶æ€æ£€æŸ¥
  âœ… å……å€¼æ¥å£è°ƒç”¨
  âœ… ç§¯åˆ†éªŒè¯
  âœ… é”™è¯¯å¤„ç†æµ‹è¯•
```

## å¸¸è§é—®é¢˜

### Q1: æç¤º"æœåŠ¡æœªå¯åŠ¨"
**è§£å†³:** å…ˆå¯åŠ¨æœåŠ¡ `go run main.go`

### Q2: æç¤º"ç”¨æˆ·ä¸å­˜åœ¨"
**åŸå› :** MongoDB ä¸­æ²¡æœ‰è¯¥é‚®ç®±çš„æµ‹è¯•ç”¨æˆ·

**è§£å†³:** ç¡®è®¤ä»¥ä¸‹æ•°æ®å­˜åœ¨:
- MongoDB users é›†åˆä¸­æœ‰ email="beetle5249@gmail.com" çš„ç”¨æˆ·
- MongoDB user_credits é›†åˆä¸­æœ‰å¯¹åº”çš„ç§¯åˆ†è®°å½•

### Q3: å……å€¼æˆåŠŸä½†ç§¯åˆ†æ²¡å˜
**å¯èƒ½åŸå› :**
1. MongoDB è¿æ¥å¤±è´¥ - æ£€æŸ¥ç¯å¢ƒå˜é‡ `MONGODB_URI`
2. Fabric é“¾ç è°ƒç”¨å¤±è´¥ - æŸ¥çœ‹æœåŠ¡ç«¯æ—¥å¿—

**è§£å†³:** æŸ¥çœ‹æœåŠ¡ç«¯çš„è¯¦ç»†é”™è¯¯æ—¥å¿—

## ä¿®æ”¹æµ‹è¯•å‚æ•°

å¦‚éœ€ä¿®æ”¹æµ‹è¯•å‚æ•°,ç¼–è¾‘æµ‹è¯•è„šæœ¬ä¸­çš„å¸¸é‡:

### Go ç‰ˆæœ¬ (test_recharge.go)
```go
const (
    BaseURL    = "http://localhost:8080"
    TestEmail  = "beetle5249@gmail.com"      // â† ä¿®æ”¹æµ‹è¯•é‚®ç®±
    TestUserID = "691058f50987397c91e4e078"   // â† ä¿®æ”¹æµ‹è¯•ç”¨æˆ·ID
)
```

### Bash ç‰ˆæœ¬ (test_recharge_api.sh)
```bash
API_URL="http://localhost:8080"
TEST_EMAIL="beetle5249@gmail.com"           # â† ä¿®æ”¹æµ‹è¯•é‚®ç®±
USER_ID="691058f50987397c91e4e078"          # â† ä¿®æ”¹æµ‹è¯•ç”¨æˆ·ID
```

## æŸ¥çœ‹æ—¥å¿—

æµ‹è¯•è¿è¡Œæ—¶,å¯ä»¥åœ¨æœåŠ¡ç«¯ç»ˆç«¯çœ‹åˆ°è¯¦ç»†çš„æ—¥å¿—è¾“å‡º:

```
ğŸ“¥ æ”¶åˆ°å……å€¼å›è°ƒ: email=beetle5249@gmail.com, order_sn=TEST_ORDER_1706234567, actual_price=150, good_name=150 Tokenå¥—é¤
âœ… æ‰¾åˆ°ç”¨æˆ·: email=beetle5249@gmail.com, userId=691058f50987397c91e4e078
âœ… MongoDB åŒæ­¥æ›´æ–°æˆåŠŸ
âœ… å……å€¼æˆåŠŸ: userId=691058f50987397c91e4e078, å¢åŠ token=150, æ–°ç§¯åˆ†=194
```

è¿™äº›æ—¥å¿—å¯ä»¥å¸®åŠ©ä½ è°ƒè¯•å’ŒéªŒè¯åŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚
